# โ ุชูุฑูุฑ ุฅููุงู ุงูุชุนุฏููุงุช: Flutter ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ ููุฎุต ุงูุชุนุฏููุงุช ุงููููุฐุฉ

### โ ุงููููุงุช ุงููุนุฏูุฉ:

#### 1. `features/merchant/presentation/screens/merchant_store_setup_screen.dart`

**ุงูุชุนุฏููุงุช:**
1. โ ุฅุถุงูุฉ import ูู `ApiService`:
   ```dart
   import '../../../../core/services/api_service.dart';
   ```

2. โ ุชุนุฏูู `_loadStore()` ูุงุณุชุฎุฏุงู Worker API:
   - **ูุจู:** ุงุณุชุฎุฏุงู Supabase ูุจุงุดุฑุฉ `.from('stores').select().eq('owner_id', user.id)`
   - **ุจุนุฏ:** ุงุณุชุฎุฏุงู Worker API `ApiService.get('/secure/merchant/store')`
   - **ุงูููุงุฆุฏ:** 
     - ูุชูุงูู ูุน ููุทู Backend ุงูุฌุฏูุฏ
     - ูุญุชุฑู RLS Policies
     - ูุชู ุฌูุจ `owner_id` ูู JWT ูู Backend

3. โ ุชุนุฏูู `_createStore()` ูุงุณุชุฎุฏุงู Worker API:
   - **ูุจู:** ุงุณุชุฎุฏุงู Supabase ูุจุงุดุฑุฉ `.from('stores').insert({ 'owner_id': user.id, ... })`
   - **ุจุนุฏ:** ุงุณุชุฎุฏุงู Worker API `ApiService.post('/secure/merchant/store', data: {...})`
   - **ุงูุชุบููุฑุงุช:**
     - โ ุฅุฒุงูุฉ `owner_id` ูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ (ูุชู ุฌูุจูุง ูู JWT ูู Backend)
     - โ ุงุณุชุฎุฏุงู Worker API ููุชุญูู ูู ุงูุตูุงุญูุงุช
     - โ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก ูู API

#### 2. `features/auth/data/auth_service.dart`

**ุงูุชุนุฏููุงุช:**
1. โ ุฅุฒุงูุฉ import ุบูุฑ ูุณุชุฎุฏู:
   ```dart
   // ุชู ุฅุฒุงูุฉ:
   import 'dart:convert';
   import 'package:http/http.dart' as http;
   ```

2. โ ุชุนุฏูู ุฅูุดุงุก ุงููุชุฌุฑ ููุชุงุฌุฑ:
   - **ูุจู:** ุงุณุชุฎุฏุงู endpoint ูุฏูู `/public/register` ูุน `http.post`
   - **ุจุนุฏ:** ุงุณุชุฎุฏุงู Worker API `/secure/merchant/store` ูุน `ApiService.post`
   - **ุงูุชุบููุฑุงุช:**
     - โ ุงุณุชุฎุฏุงู Worker API ุงูุฌุฏูุฏ
     - โ ุฅุฒุงูุฉ `user_id` ูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ (ูุชู ุฌูุจูุง ูู JWT)
     - โ ุงุณุชุฎุฏุงู `ApiService` ุงูููุญุฏ ููุงุชุณุงู

---

## โ ูุฑุงุฌุนุฉ ุงูููุงุท ุงููุฐููุฑุฉ ูู ุงูุชูุฑูุฑ

### 1. โ ุงุณุชุฎุฏุงู `user_profiles.id = auth.users.id`
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100%
- โ ุฌููุน ุงูุงุณุชุฎุฏุงูุงุช ุชุณุชุฎุฏู `id` ูุจุงุดุฑุฉ
- โ ูุง ููุฌุฏ ุงุณุชุฎุฏุงู ูู `user_id` ูููุตู
- โ ูุง ููุฌุฏ ุงุณุชุฎุฏุงู ูู `full_name`

### 2. โ ุงุณุชุฎุฏุงู `stores.owner_id = user_profiles.id`
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100% (ุจุนุฏ ุงูุชุนุฏููุงุช)
- โ ุฌูุจ Store ุนุจุฑ Worker API
- โ ุฅูุดุงุก Store ุนุจุฑ Worker API (ูุง ูุฑุณู `owner_id` ูู Flutter)
- โ `owner_id` ูุชู ุฌูุจูุง ูู JWT ูู Backend

### 3. โ ุงุณุชุฎุฏุงู `products.store_id = stores.id`
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100%
- โ ูุง ูุฑุณู `store_id` ูู Flutter
- โ ูุชู ุฌูุจ `store_id` ูู JWT โ profile โ stores ูู Backend

### 4. โ StoreSession Provider
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100%
- โ ูุนูู ุจุดูู ุตุญูุญ
- โ ูุญูุธ `store_id` ุจุนุฏ ุฌูุจูุง ูู API

### 5. โ ุฌูุจ `store_id` ุนุจุฑ `/secure/merchant/store`
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100%
- โ ุฌููุน ุงูุฃูุงูู ุชุณุชุฎุฏู Worker API

### 6. โ ุนุฏู ุฅุฑุณุงู `store_id` ูู Flutter ุนูุฏ ุฅูุดุงุก ุงูููุชุฌ
**ุงูุญุงูุฉ:** โ ูุชูุงูู 100%
- โ ุชู ุงูุชุญูู ูุงูุชูุธูู

---

## โ๏ธ ุงูููุงุท ุงููุฐููุฑุฉ ูู ุงูุชูุฑูุฑ (ุชู ูุฑุงุฌุนุชูุง)

### 1. โ๏ธ ุงุณุชุฎุฏุงู `stock_quantity` ุจุฏูุงู ูู `stock`
**ุงูุญุงูุฉ:** โ **ูุง ูุดููุฉ - ูุฏุนู ููุง ุงูุญูููู**
- **ุงููููุงุช:** `merchant_products_screen.dart`
- **ุงูููุฏ:** `product['stock'] ?? product['stock_quantity'] ?? 0`
- **ุงูุณุจุจ:** ูุฏุนู ุงูุจูุงูุงุช ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ (fallback)
- **ุงูุชูุตูุฉ:** โ **ูุง ูุญุชุงุฌ ุชุนุฏูู** - ูุฐุง ุตุญูุญ ููุชูุงูู ูุน ุงูุจูุงูุงุช ุงููุฏููุฉ

### 2. โ๏ธ ุนุฏู ูุฌูุฏ ุชุญูู ูู `is_active` ูู `stores`
**ุงูุญุงูุฉ:** โ **ูุชู ุงูุชุญูู ูู Backend**
- **ุงูุชุญูู:** ูุชู ูู Edge Function `product_create/index.ts`
- **ุงูููุฏ:** `.eq('is_active', true)`
- **ุงูุชูุตูุฉ:** โ **ูุง ูุญุชุงุฌ ุชุนุฏูู ูู Flutter** - Backend ูุชุญูู

### 3. โ๏ธ ุจุนุถ ุงูุฃูุงูู ุชุณุชุฎุฏู `owner_id` ูุจุงุดุฑุฉ ูู Supabase
**ุงูุญุงูุฉ:** โ **ุชู ุฅุตูุงุญูุง**
- **ุงููููุงุช ุงููุนุฏูุฉ:**
  - โ `merchant_store_setup_screen.dart` - ุชู ุงูุชุนุฏูู
  - โ `auth_service.dart` - ุชู ุงูุชุนุฏูู
- **ุงููุชูุฌุฉ:** ุฌููุน ุงูุฃูุงูู ุชุณุชุฎุฏู Worker API ุงูุขู

---

## ๐ ุงูุชูุงูู ุงูููุงุฆู

| ุงููููู | ูุจู ุงูุชุนุฏููุงุช | ุจุนุฏ ุงูุชุนุฏููุงุช |
|--------|---------------|---------------|
| `user_profiles` | โ 100% | โ 100% |
| `stores.owner_id` | โ๏ธ 95% | โ 100% |
| `products.store_id` | โ 100% | โ 100% |
| StoreSession | โ 100% | โ 100% |
| API Integration | โ 100% | โ 100% |
| **ุงูุชูุงูู ุงูุนุงู** | **โ 98%** | **โ 100%** |

---

## โ Checklist ุงูุชูููุฐ

### ูุจู ุงูุชุนุฏููุงุช:
- [x] โ ูุฑุงุกุฉ ุงูุชูุฑูุฑ ุงููุฎุชุตุฑ
- [x] โ ุชุญุฏูุฏ ุงููููุงุช ุงูุชู ุชุญุชุงุฌ ุชุนุฏูู
- [x] โ ููู ุงูุณูุงู ุงููุงูู

### ุงูุชุนุฏููุงุช ุงููููุฐุฉ:
- [x] โ ุชุนุฏูู `merchant_store_setup_screen.dart`:
  - [x] ุฅุถุงูุฉ import ูู `ApiService`
  - [x] ุชุนุฏูู `_loadStore()` ูุงุณุชุฎุฏุงู Worker API
  - [x] ุชุนุฏูู `_createStore()` ูุงุณุชุฎุฏุงู Worker API
  
- [x] โ ุชุนุฏูู `auth_service.dart`:
  - [x] ุฅุฒุงูุฉ imports ุบูุฑ ูุณุชุฎุฏูุฉ
  - [x] ุชุนุฏูู ุฅูุดุงุก ุงููุชุฌุฑ ูุงุณุชุฎุฏุงู Worker API

### ุจุนุฏ ุงูุชุนุฏููุงุช:
- [x] โ ูุฑุงุฌุนุฉ ุฌููุน ุงูููุงุท ุงููุฐููุฑุฉ ูู ุงูุชูุฑูุฑ
- [x] โ ุงูุชุญูู ูู ุงูุชูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] โ ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก syntax

---

## ๐ฏ ุงูุฎูุงุตุฉ

### โ ุฌููุน ุงูุชุนุฏููุงุช ุชู ุชูููุฐูุง ุจูุฌุงุญ!

**ุงููุชูุฌุฉ:**
- โ ุงูุชูุงูู ุงูุนุงู: **100%**
- โ ุฌููุน ุงููููุงุช ุชุณุชุฎุฏู Worker API
- โ ูุง ูุชู ุฅุฑุณุงู `owner_id` ุฃู `store_id` ูู Flutter
- โ ุฌููุน ุงูุนูุงูุงุช ุตุญูุญุฉ ููุชูุงููุฉ ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุฎุทูุงุช ุงูุชุงููุฉ:**
1. โ ุชุดุบูู Migration ูู Supabase
2. โ ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงููุชุฌุฑ
3. โ ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงูููุชุฌุงุช
4. โ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู ุงูุดุงูู

---

**ุงูุชูุฑูุฑ ุฃุนุฏ ูู:** 6 ููุงูุฑ 2025
**ุงูุญุงูุฉ:** โ **ููุชูู**

