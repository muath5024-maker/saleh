# ุฏููู ุงูุงุฎุชุจุงุฑ ุงููุงูู - ูุธุงู ุงููุชุงุฌุฑ Multi-Tenant

## ๐ ูุชุทูุจุงุช ูุง ูุจู ุงูุงุฎุชุจุงุฑ

### 1. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```sql
-- ูููุฐ ุงูููู: CREATE_STORE_SETTINGS_TABLE.sql
-- ูู Supabase SQL Editor
```

### 2. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ ุงููุญููุฉ

```bash
cd mbuy-stores
npm install

# ุงูุณุฎ .env.local.example ุฅูู .env.local
cp .env.local.example .env.local

# ุญุฏูุซ ุงูููู:
# NEXT_PUBLIC_WORKER_API_URL=https://misty-mode-b68b.baharista1.workers.dev
# NEXT_PUBLIC_MAIN_DOMAIN=mbuy.pro
```

### 3. ุฅุนุฏุงุฏ DNS ุงููุญูู (ููุชุทููุฑ)

#### Windows (hosts file):
```
C:\Windows\System32\drivers\etc\hosts
```
ุฃุถู:
```
127.0.0.1 test-store.mbuy.pro
127.0.0.1 fashion-store.mbuy.pro
```

#### macOS/Linux:
```bash
sudo nano /etc/hosts
```
ุฃุถู:
```
127.0.0.1 test-store.mbuy.pro
127.0.0.1 fashion-store.mbuy.pro
```

---

## ๐งช ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุณููุงุฑูู 1: ุฅูุดุงุก ูุชุฌุฑ ุฌุฏูุฏ (Onboarding Flow)

#### ุงูุฎุทูุฉ 1: ุงูุจุฏุก
1. ุดุบูู Next.js: `npm run dev`
2. ุงูุชุญ: `http://localhost:3000/onboarding`
3. ูุฌุจ ุฃู ุชุธูุฑ ุตูุญุฉ Onboarding - Step 1

#### ุงูุฎุทูุฉ 2: ุฅุฏุฎุงู ุจูุงูุงุช ุงููุชุฌุฑ
1. **ุงุณู ุงููุชุฌุฑ:** "ูุชุฌุฑ ุงูุฃุฒูุงุก ุงูุฑุงููุฉ"
2. **ุฑุงุจุท ุงููุชุฌุฑ:** ูุฌุจ ุฃู ูุชููุฏ ุชููุงุฆูุงู "ูุชุฌุฑ-ุงูุฃุฒูุงุก-ุงูุฑุงููุฉ"
   - ุบููุฑู ุฅูู: "fashion-store"
   - ูุฌุจ ุฃู ูุธูุฑ: "โ ุงูุฑุงุจุท ูุชุงุญ"
3. **ูุตู ุงููุชุฌุฑ:** "ูุชุฌุฑ ูุชุฎุตุต ูู ุงูุฃุฒูุงุก ุงูุฑุงููุฉ ูุงูุนุตุฑูุฉ"
4. **ุงููุฏููุฉ:** "ุงูุฑูุงุถ"
5. ุงุถุบุท "ุงูุชุงูู"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุงูุงูุชูุงู ุฅูู Step 2 (ุดุงุดุฉ ุงูุชุฑุญูุจ)
- ุนุฑุถ ูุฑุช ูุฏูุฉ ูุน 5 ุนูุงุตุฑ
- ุนุฑุถ ุฑุงุจุท ุงููุชุฌุฑ: `fashion-store.mbuy.pro`

#### ุงูุฎุทูุฉ 3: ุดุงุดุฉ ุงูุชุฑุญูุจ
1. ุชุญูู ูู ุนุฑุถ:
   - ุนููุงู ุงูุชุฑุญูุจ
   - 4 ูุฑูุช ูุฏูุฉ
   - ุฑุงุจุท ุงููุชุฌุฑ ูู gradient box
2. ุงุถุบุท "ุงูุชุงูู"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุงูุงูุชูุงู ุฅูู Step 3 (ุงูุฃุณุฆูุฉ)

#### ุงูุฎุทูุฉ 4: ุงูุฃุณุฆูุฉ ุงูุฐููุฉ
1. **ุงูุณุคุงู 1:** ูู ูู ุฌูููุฑู ุงููุณุชูุฏูุ
   - ุงุฎุชุฑ: "ูุณุงุก"
2. ุงุถุบุท "ุงูุณุคุงู ุงูุชุงูู"
3. **ุงูุณุคุงู 2:** ูุง ููุน ุงูููุชุฌุงุชุ
   - ุงุฎุชุฑ: "ุฃุฒูุงุก ูููุงุจุณ"
4. ุงุถุบุท "ุงูุณุคุงู ุงูุชุงูู"
5. **ุงูุณุคุงู 3:** ูุง ูุทุงู ุงูุฃุณุนุงุฑุ
   - ุงุฎุชุฑ: "ุฑุงูู (500-2000 ุฑ.ุณ)"
6. ุงุถุบุท "ุงูุณุคุงู ุงูุชุงูู"
7. **ุงูุณุคุงู 4:** ูุง ูู ุฃุณููุจ ูุชุฌุฑูุ
   - ุงุฎุชุฑ: "ูุงุฎุฑ ููููุฒ"
8. ุงุถุบุท "ุงูุชุงูู"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุงูุงูุชูุงู ุฅูู Step 4 (ุงูุชุฑุงุญุงุช AI)
- Progress bar ูุตู ุฅูู 80%

#### ุงูุฎุทูุฉ 5: ุงูุชุฑุงุญุงุช AI
1. ุชุญูู ูู ุนุฑุถ:
   - 3 ุดุนุงุฑุงุช ููุชุฑุญุฉ
   - 3 ุชุฏุฑุฌุงุช ุฃููุงู
   - 3 ููุงูุจ
2. ุงุฎุชุฑ:
   - ุดุนุงุฑ (ุฃู ูุงุญุฏ)
   - ุชุฏุฑุฌ ููู: "ุจููุณุฌู ุนุตุฑู"
   - ูุงูุจ: "ุนุตุฑู"
3. ุงุถุบุท "ุงูุชุงูู"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุงูุงูุชูุงู ุฅูู Step 5 (ุงูุดุงุช)

#### ุงูุฎุทูุฉ 6: ุงูุดุงุช ูุฅููุงู ุงููููุฉ
1. ุงูุชุจ ุฑุณุงูุฉ: "ุฃุฑูุฏ ูุชุฌุฑ ุฃููู ูุนุตุฑู"
2. ุงุถุบุท Send
3. ุงูุชุธุฑ ุฑุฏ AI
4. ุงุถุบุท "ุฅููุงุก ูุฅูุดุงุก ุงููุชุฌุฑ"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุฅูุดุงุก ุงููุชุฌุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุชูุฌูู ุฅูู: `https://fashion-store.mbuy.pro`
- (ูู Development: `http://fashion-store.mbuy.pro:3000`)

---

### ุงูุณููุงุฑูู 2: ุนุฑุถ ุงููุชุฌุฑ

#### ุงูุฎุทูุฉ 1: ุงููุตูู ูููุชุฌุฑ
1. ุจุนุฏ ุฅูุดุงุก ุงููุชุฌุฑุ ุณูุชู ุงูุชูุฌูู ุชููุงุฆูุงู
2. ุฃู ุงูุชุญ: `http://fashion-store.mbuy.pro:3000`

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุนุฑุถ ุตูุญุฉ ุงููุชุฌุฑ
- Header ูุน:
  - Cover image (ุฅู ููุฌุฏ)
  - Logo (ุฅู ููุฌุฏ)
  - ุงุณู ุงููุชุฌุฑ
  - ูุตู ุงููุชุฌุฑ

#### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุซูู
1. ุชุญูู ูู ุชุทุจูู ุงูุฃููุงู:
   - Primary color: ุจููุณุฌู (#7C3AED)
   - Buttons: ุจููุณุฌู
   - Cards: ุชุทุจูู border radius ู shadow

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุงูุซูู ูุทุจูู ุจุดูู ุตุญูุญ
- ุงูุฃููุงู ูุชุทุงุจูุฉ ูุน ุงูุงุฎุชูุงุฑ

#### ุงูุฎุทูุฉ 3: ุนุฑุถ ุงูููุชุฌุงุช
1. ุชุญูู ูู:
   - ุนููุงู "ุงูููุชุฌุงุช"
   - Grid ูู ProductCards
   - ูู ProductCard ูุนุฑุถ:
     - ุตูุฑุฉ ุงูููุชุฌ
     - ุงุณู ุงูููุชุฌ
     - ุงูุณุนุฑ
     - ุฒุฑ "ุฃุถู ููุณูุฉ"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุนุฑุถ ุงูููุชุฌุงุช ุจุดูู ุตุญูุญ
- ุงูุชุตููู responsive

---

### ุงูุณููุงุฑูู 3: ุงุฎุชุจุงุฑ Worker APIs

#### Test 1: Get Store
```bash
curl https://misty-mode-b68b.baharista1.workers.dev/public/store/fashion-store
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "ok": true,
  "data": {
    "id": "...",
    "name": "ูุชุฌุฑ ุงูุฃุฒูุงุก ุงูุฑุงููุฉ",
    "slug": "fashion-store",
    "description": "...",
    "is_active": true
  }
}
```

#### Test 2: Get Theme
```bash
curl https://misty-mode-b68b.baharista1.workers.dev/public/store/fashion-store/theme
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "ok": true,
  "data": {
    "theme_id": "modern",
    "primary_color": "#7C3AED",
    "secondary_color": "#9333EA"
  }
}
```

#### Test 3: Get Branding
```bash
curl https://misty-mode-b68b.baharista1.workers.dev/public/store/fashion-store/branding
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "ok": true,
  "data": {
    "logo_url": "...",
    "cover_image_url": "...",
    "colors": {
      "primary": "#7C3AED",
      "secondary": "#9333EA"
    }
  }
}
```

#### Test 4: Check Slug (ูุญุชุงุฌ JWT)
```bash
# ุงุญุตู ุนูู JWT token ุฃููุงู ูู /auth/supabase/login
TOKEN="your-jwt-token"

curl -H "Authorization: Bearer $TOKEN" \
  "https://misty-mode-b68b.baharista1.workers.dev/secure/store/check-slug?slug=new-store"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "ok": true,
  "data": {
    "available": true,
    "slug": "new-store"
  }
}
```

---

### ุงูุณููุงุฑูู 4: ุงุฎุชุจุงุฑ Slug Uniqueness

#### Test 1: ุฅูุดุงุก ูุชุฌุฑ ุจู slug ููุฌูุฏ
1. ุญุงูู ุฅูุดุงุก ูุชุฌุฑ ุฌุฏูุฏ ุจู slug: "fashion-store"
2. ูู Step 1ุ ุฃุฏุฎู slug ููุฌูุฏ

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุฑุณุงูุฉ ุฎุทุฃ: "ูุฐุง ุงูุฑุงุจุท ูุณุชุฎุฏู ุจุงููุนู"
- ุนุฏู ุงูุณูุงุญ ุจุงููุชุงุจุนุฉ

#### Test 2: Slug ุบูุฑ ุตุญูุญ
1. ุฃุฏุฎู slug: "Fashion Store!" (ูุญุชูู ูุณุงูุงุช ูุฑููุฒ)
2. ุงุถุบุท "ุงูุชุงูู"

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- ุฑุณุงูุฉ ุฎุทุฃ: "ุฑุงุจุท ุงููุชุฌุฑ ุบูุฑ ุตุญูุญ"
- Auto-clean: ุฅุฒุงูุฉ ุงููุณุงูุงุช ูุงูุฑููุฒ

---

### ุงูุณููุงุฑูู 5: ุงุฎุชุจุงุฑ Themes

#### Test 1: Modern Theme
1. ุฃูุดุฆ ูุชุฌุฑ ูุงุฎุชุฑ theme: "modern"
2. ุงูุชุญ ุงููุชุฌุฑ
3. ุชุญูู ูู:
   - Border radius: 12px-16px
   - Colors: ุฃุฒุฑู ูุจููุณุฌู
   - Font: Inter

#### Test 2: Classic Theme
1. ุฃูุดุฆ ูุชุฌุฑ ูุงุฎุชุฑ theme: "classic"
2. ุงูุชุญ ุงููุชุฌุฑ
3. ุชุญูู ูู:
   - Border radius: 4px-8px
   - Colors: ุฑูุงุฏู ูุฃุญูุฑ
   - Font: Georgia

#### Test 3: Minimal Theme
1. ุฃูุดุฆ ูุชุฌุฑ ูุงุฎุชุฑ theme: "minimal"
2. ุงูุชุญ ุงููุชุฌุฑ
3. ุชุญูู ูู:
   - Border radius: 0px
   - Colors: ุฃุณูุฏ ูุฃุจูุถ
   - Font: Helvetica

---

## ๐ Troubleshooting

### ุงููุดููุฉ: ุงููุชุฌุฑ ูุง ูุธูุฑ
**ุงูุญู:**
1. ุชุญูู ูู ุฃู `is_active = true` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุชุญูู ูู ุฃู slug ุตุญูุญ
3. ุชุญูู ูู Worker API response

### ุงููุดููุฉ: ุงูุซูู ูุง ูุทุจู
**ุงูุญู:**
1. ุชุญูู ูู ูุฌูุฏ `store_settings` ูููุชุฌุฑ
2. ุชุญูู ูู Worker API `/public/store/{slug}/theme`
3. ุชุญูู ูู ุชุทุจูู CSS ูู ุงููุชุตูุญ

### ุงููุดููุฉ: Onboarding ูุง ูููู
**ุงูุญู:**
1. ุชุญูู ูู JWT token (ูุญุชุงุฌ authentication)
2. ุชุญูู ูู Worker API logs
3. ุชุญูู ูู console errors ูู ุงููุชุตูุญ

### ุงููุดููุฉ: Slug ุบูุฑ ูุชุงุญ ุฏุงุฆูุงู
**ุงูุญู:**
1. ุชุญูู ูู Worker API `/secure/store/check-slug`
2. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ
3. ุชุญูู ูู JWT token

---

## โ Checklist ุงูุงุฎุชุจุงุฑ

- [ ] Onboarding Flow ูุนูู ูู ุงูุจุฏุงูุฉ ููููุงูุฉ
- [ ] Slug validation ูุนูู
- [ ] Slug availability check ูุนูู
- [ ] Store creation ูุนูู
- [ ] Store frontend ูุนุฑุถ ุงูุจูุงูุงุช
- [ ] Theme application ูุนูู
- [ ] Product display ูุนูู
- [ ] Worker APIs ุชุนูู (Public + Secure)
- [ ] Subdomain routing ูุนูู
- [ ] Responsive design ูุนูู
- [ ] RTL support ูุนูู

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-12-15
